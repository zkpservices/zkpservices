export const description =
  'On this page, weâ€™ll dive into the different user endpoints you can use to manage user data programmatically.'

# User Data

User data is the foundation of the zkp.services solution. On this page, we'll dive into the API requests that our dApp makes with our backend API in order to control your data securely. {{ className: 'lead' }}

## The structure of user data

Our data model is an extremely versatile JSON object that gives way to an endless number of data points a user is able to store, for countless different services. As such, below we will provide an example of a potential data structure for user data, but note that none of the fields in the data object are specifically required.

### Properties

<Properties>
  <Property name="id" type="string">
    Unique wallet address identifier for the user.
  </Property>
  <Property name="password" type="string">
    The password associated with the user.
  </Property>
  <Property name="requests_sent" type="JSON Object[]">
    A list of requests sent by the user.
  </Property>
  <Property name="requests_received" type="JSON Object[]">
    A list of requests received for the user's data, by other users.
  </Property>
  <Property name="responses_sent" type="JSON Object[]">
    A list of responses sent by the user.
  </Property>
  <Property name="responses_received" type="JSON Object[]">
    A list of responses received by the user, of other users data.
  </Property>
</Properties>

---

## Retrieve user data {{ tag: 'POST', label: '/test/userdata-api, action: "get_item"' }}

<Row>
  <Col>

    This endpoint allows you to retrieve either the entire, or a subset, of the "data" object for the self user.

    Authorization is required.

    ### Required attributes

    <Properties>
      <Property name="id" type="string">
        The wallet address of the user.
      </Property>
      <Property name="password" type="string">
        The hash of the password of the user.
      </Property>
      <Property name="action" type="string">
        The action of this request, which is "get_item".
      </Property>
      <Property name="key" type="string">
        The flattened JSON key for the property trying to be retrieved, for example, "medical records - pharmacy central melbourne.data.active prescriptions".
      </Property>
    </Properties>

    ### Optional attributes

    <Properties>
      <Property name="key" type="string">
        The flattened JSON key for the property trying to be retrieved, for example, "medical records - pharmacy central melbourne.data.active prescriptions".
        If not provided, will return the entire data set for user.
      </Property>
    </Properties>

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="GET" label="/v1/contacts">

    ```bash {{ title: 'cURL' }}
    curl --location --request POST https://yrd4sydg5g.execute-api.us-east-1.amazonaws.com/test/userdata-api' \
    --header 'Content-Type: application/json' \
    --data-raw '{
        "id": "Ox4",
        "action": "get_item",
        "password": "abc123",
        "key": "medical records - pharmacy central melbourne.data.active prescriptions.Amoxicillin"
    }'
    ```

    ```js
    var settings = {
      "url": "https://yrd4sydg5g.execute-api.us-east-1.amazonaws.com/test/userdata-api",
      "method": "POST",
      "timeout": 0,
      "headers": {
        "Content-Type": "application/json"
      },
      "data": JSON.stringify({
        "id": "Ox4",
        "action": "get_item",
        "password": "abc123",
        "key": "medical records - pharmacy central melbourne.data.active prescriptions.Amoxicillin"
      }),
    };

    $.ajax(settings).done(function (response) {
      console.log(response);
    });
    ```

    ```python
    import requests
    import json

    url = "https://yrd4sydg5g.execute-api.us-east-1.amazonaws.com/test/userdata-api"

    payload = json.dumps({
      "id": "Ox4",
      "action": "get_item",
      "password": "abc123",
      "key": "medical records - pharmacy central melbourne.data.active prescriptions.Amoxicillin"
    })
    headers = {
      'Content-Type': 'application/json'
    }

    response = requests.request("POST", url, headers=headers, data=payload)

    print(response.text)

    ```

    ```powershell {{ title: 'Powershell' }}
    $headers = New-Object "System.Collections.Generic.Dictionary[[String],[String]]"
    $headers.Add("Content-Type", "application/json")

    $body = "{
    `n    `"id`": `"Ox4`",
    `n    `"action`": `"get_item`",
    `n    `"password`": `"abc123`",
    `n    `"key`": `"medical records - pharmacy central melbourne.data.active prescriptions.Amoxicillin`"
    `n}"

    $response = Invoke-RestMethod 'https://yrd4sydg5g.execute-api.us-east-1.amazonaws.com/test/userdata-api' -Method 'POST' -Headers $headers -Body $body
    $response | ConvertTo-Json
    ```

    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
        "medical records - pharmacy central melbourne.data.active prescriptions.Amoxicillin": {
            "usage": "Antibiotic",
            "dosage": "250mg to 500mg every 8 hours or 875mg every 12 hours",
            "refills remaining": "3 for 50 x 1g or equivalent"
        }
    }
    ```

  </Col>
</Row>

---

## Create a user and dataset {{ tag: 'POST', label: '/test/userdata-api, action: "create_item"' }}

<Row>
  <Col>

    This endpoint allows you to create a new user and associated dataset. You can only add a user from a wallet that you own.

    ### Required attributes

    <Properties>
      <Property name="id" type="string">
        The wallet address of the user.
      </Property>
      <Property name="password" type="string">
        The hash of the password of the user.
      </Property>
      <Property name="action" type="string">
        The action of this request, which is "create_item".
      </Property>
      <Property name="data" type="string">
        Contains the initial JSON dataset for a user. Can be empty {}.
      </Property>
      <Property name="requests_sent" type="JSON Object">
        The object containing the set of requests sent. This will usually be empty "\{\}" unless a user is being copied over from another database.
      </Property>
      <Property name="requests_received" type="JSON Object">
        The object containing the set of requests received. This will usually be empty "\{\}" unless a user is being copied over from another database.
      </Property>
      <Property name="responses_sent" type="JSON Object">
        The object containing the set of responses sent. This will usually be empty "\{\}" unless a user is being copied over from another database.
      </Property>
      <Property name="responses_received" type="JSON Object">
        The object containing the set of requests received. This will usually be empty "\{\}" unless a user is being copied over from another database.
      </Property>

    </Properties>
    

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="POST" label="/v1/contacts">

    ```bash {{ title: 'cURL' }}
      curl --location --request POST 'https://yrd4sydg5g.execute-api.us-east-1.amazonaws.com/test/userdata-api' \
      --header 'Content-Type: application/json' \
      --data-raw '{
          "id": "Ox234",
          "action": "create_item",
          "password": "abc123",
          "data": {
              "id": {
                  "name": "Johnathan Doe",
                  "DOB": "25/03/2002"
              }
          },
          "requests_sent": {},
          "requests_received": {},
          "responses_sent": {},
          "responses_received": {}
          
      }'
    ```

    ```js
    var settings = {
      "url": "https://yrd4sydg5g.execute-api.us-east-1.amazonaws.com/test/userdata-api",
      "method": "POST",
      "timeout": 0,
      "headers": {
        "Content-Type": "application/json"
      },
      "data": JSON.stringify({
        "id": "Ox234",
        "action": "create_item",
        "password": "abc123",
        "data": {
          "id": {
            "name": "Johnathan Doe",
            "DOB": "25/03/2002"
          }
        },
        "requests_sent": {},
        "requests_received": {},
        "responses_sent": {},
        "responses_received": {}
      }),
    };

$.ajax(settings).done(function (response) {
  console.log(response);
});
    ```

    ```python
      import requests
      import json

      url = "https://yrd4sydg5g.execute-api.us-east-1.amazonaws.com/test/userdata-api"

      payload = json.dumps({
        "id": "Ox234",
        "action": "create_item",
        "password": "abc123",
        "data": {
          "id": {
            "name": "Johnathan Doe",
            "DOB": "25/03/2002"
          }
        },
        "requests_sent": {},
        "requests_received": {},
        "responses_sent": {},
        "responses_received": {}
      })
      headers = {
        'Content-Type': 'application/json'
      }

      response = requests.request("POST", url, headers=headers, data=payload)

      print(response.text)

    ```

    ```powershell {{ title: 'Powershell' }}
    $headers = New-Object "System.Collections.Generic.Dictionary[[String],[String]]"
    $headers.Add("Content-Type", "application/json")

    $body = "{
    `n    `"id`": `"Ox234`",
    `n    `"action`": `"create_item`",
    `n    `"password`": `"abc123`",
    `n    `"data`": {
    `n        `"id`": {
    `n            `"name`": `"Johnathan Doe`",
    `n            `"DOB`": `"25/03/2002`"
    `n        }
    `n    },
    `n    `"requests_sent`": {},
    `n    `"requests_received`": {},
    `n    `"responses_sent`": {},
    `n    `"responses_received`": {}
    `n    
    `n}"

    $response = Invoke-RestMethod 'https://yrd4sydg5g.execute-api.us-east-1.amazonaws.com/test/userdata-api' -Method 'POST' -Headers $headers -Body $body
    $response | ConvertTo-Json
    ```

    </CodeGroup>

    ```text {{ title: 'Response' }}
    User 0x234 created successfully!
    ```

  </Col>
</Row>

---

## Update a users data {{ tag: 'PUT', label: '/test/userdata-api, action: "update_item"' }}

<Row>
  <Col>

    This endpoint allows you update the data object for a specific user. <br/><br/>
    This is an <b>incremental</b> function, meaning that you supply the data \{\} json object containing only the fields you wish to update. The fields you do not specify will not be modified. If you specify a field that does not exist, it will be created.

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="PUT" label="/test/userdata-api">

    ```bash {{ title: 'cURL' }}
    curl https://api.protocol.chat/v1/contacts/WAz8eIbvDR60rouK \
      -H "Authorization: Bearer {token}"
    ```

    ```js
    import ApiClient from '@example/protocol-api'

    const client = new ApiClient(token)

    await client.contacts.get('WAz8eIbvDR60rouK')
    ```

    ```python
    from protocol_api import ApiClient

    client = ApiClient(token)

    client.contacts.get("WAz8eIbvDR60rouK")
    ```

    ```php
    $client = new \Protocol\ApiClient($token);

    $client->contacts->get('WAz8eIbvDR60rouK');
    ```

    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "id": "WAz8eIbvDR60rouK",
      "username": "FrankMcCallister",
      "phone_number": "1-800-759-3000",
      "avatar_url": "https://assets.protocol.chat/avatars/frank.jpg",
      "display_name": null,
      "conversation_id": "xgQQXg3hrtjh7AvZ",
      "last_active_at": 705103200,
      "created_at": 692233200
    }
    ```

  </Col>
</Row>

---

## Update a contact {{ tag: 'PUT', label: '/v1/contacts/:id' }}

<Row>
  <Col>

    This endpoint allows you to perform an update on a contact. Currently, the only attribute that can be updated on contacts is the `display_name` attribute which controls how a contact appears in your contact list in Protocol.

    ### Optional attributes

    <Properties>
      <Property name="display_name" type="string">
        The contact display name in the contact list. By default, this is just the username.
      </Property>
    </Properties>

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="PUT" label="/v1/contacts/WAz8eIbvDR60rouK">

    ```bash {{ title: 'cURL' }}
    curl -X PUT https://api.protocol.chat/v1/contacts/WAz8eIbvDR60rouK \
      -H "Authorization: Bearer {token}" \
      -d display_name="UncleFrank"
    ```

    ```js
    import ApiClient from '@example/protocol-api'

    const client = new ApiClient(token)

    await client.contacts.update('WAz8eIbvDR60rouK', {
        display_name: 'UncleFrank',
    })
    ```

    ```python
    from protocol_api import ApiClient

    client = ApiClient(token)

    client.contacts.update("WAz8eIbvDR60rouK", display_name="UncleFrank")
    ```

    ```php
    $client = new \Protocol\ApiClient($token);

    $client->contacts->update('WAz8eIbvDR60rouK', [
      'display_name' => 'UncleFrank',
    ]);
    ```

    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "id": "WAz8eIbvDR60rouK",
      "username": "FrankMcCallister",
      "phone_number": "1-800-759-3000",
      "avatar_url": "https://assets.protocol.chat/avatars/frank.jpg",
      "display_name": "UncleFrank",
      "conversation_id": "xgQQXg3hrtjh7AvZ",
      "last_active_at": 705103200,
      "created_at": 692233200
    }
    ```

  </Col>
</Row>

---

## Delete a contact {{ tag: 'DELETE', label: '/v1/contacts/:id' }}

<Row>
  <Col>

    This endpoint allows you to delete contacts from your contact list in Protocol. Note: This will also delete your conversation with the given contact.

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="DELETE" label="/v1/contacts/WAz8eIbvDR60rouK">

    ```bash {{ title: 'cURL' }}
    curl -X DELETE https://api.protocol.chat/v1/contacts/WAz8eIbvDR60rouK \
      -H "Authorization: Bearer {token}"
    ```

    ```js
    import ApiClient from '@example/protocol-api'

    const client = new ApiClient(token)

    await client.contacts.delete('WAz8eIbvDR60rouK')
    ```

    ```python
    from protocol_api import ApiClient

    client = ApiClient(token)

    client.contacts.delete("WAz8eIbvDR60rouK")
    ```

    ```php
    $client = new \Protocol\ApiClient($token);

    $client->contacts->delete('WAz8eIbvDR60rouK');
    ```

    </CodeGroup>

  </Col>
</Row>
